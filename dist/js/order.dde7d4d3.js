(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["order"],{"49c8":function(t,i,e){"use strict";e.r(i);var s=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"order-box"},[e("s-header",{attrs:{name:"order in advance history order",back:"/user"}}),e("van-tabs",{staticClass:"order-tab",attrs:{color:"#1baeae","title-active-color":"#1baeae"},on:{change:t.onChangeTab},model:{value:t.status,callback:function(i){t.status=i},expression:"status"}},[e("van-tab",{attrs:{title:"Orders in the reservation",name:"0"}}),e("van-tab",{attrs:{title:"Historical order",name:"1"}})],1),e("van-pull-refresh",{staticClass:"order-list-refresh",on:{refresh:t.onRefresh},model:{value:t.refreshing,callback:function(i){t.refreshing=i},expression:"refreshing"}},[e("van-list",{attrs:{finished:t.finished,"finished-text":"No more"},on:{load:t.onLoad,offset:function(t){}},model:{value:t.loading,callback:function(i){t.loading=i},expression:"loading"}},t._l(t.list,(function(i,s){return e("div",{key:s,staticClass:"order-item-box"},[e("div",{staticClass:"order-item-header"},[0==i.billType?e("span",[t._v("Buy back:")]):e("span",[t._v("Buy booking:")]),e("span",[t._v(" Order No. "),e("span",[t._v(t._s(i.billNumber))])])]),e("van-card",{attrs:{title:i.detail.goodsName,thumb:t.prefix(i.detail.goodsCoverImg)}},[e("div",{staticClass:"quan",attrs:{slot:"desc"},slot:"desc"},[i.buyingPoint>1e3?e("span",{staticClass:"item"},[t._v("10gm")]):e("span",{staticClass:"item"},[t._v("500gm")]),e("span",{staticClass:"item"},[t._v("Quantity:"+t._s(i.ops))])]),e("div",{staticClass:"item-price",attrs:{slot:"price"},slot:"price"},[e("div",{staticClass:"price-buy"},[t._v(" ₹"+t._s(i.buyingPoint)+"/ "),i.buyingPoint>2e3?e("span",[t._v("₹"+t._s(t.goldPrice))]):e("span",[t._v("₹"+t._s(t.silverPrice))])]),e("div",{staticClass:"price-now"},[t._v(" Current different value: "),0==i.billType&&i.buyingPoint>2e3?e("span",[t._v(t._s((10*(Number(t.goldPrice)-Number(i.buyingPoint))*i.ops).toFixed(2)))]):t._e(),0==i.billType&&i.buyingPoint<2e3?e("span",[t._v(t._s((500*(Number(t.silverPrice)-Number(i.buyingPoint))*i.ops).toFixed(2)))]):t._e(),1==i.billType&&i.buyingPoint>2e3?e("span",[t._v(t._s((10*(Number(i.buyingPoint)-Number(t.goldPrice))*i.ops).toFixed(2)))]):t._e(),1==i.billType&&i.buyingPoint<2e3?e("span",[t._v(t._s((500*(Number(i.buyingPoint)-Number(t.silverPrice))*i.ops).toFixed(2)))]):t._e()]),e("div",{staticClass:"price-now"},[t._v(" Created time: "),e("span",[t._v(t._s(i.createTime))])])])]),e("div",{staticClass:"buy-again"},[e("div",{staticClass:"again-left"},[e("span",[t._v("Pre-payment:₹"+t._s(300*i.ops))]),e("span",[t._v("(including serve fee)")])]),0==t.billStatus?e("div",{staticClass:"again-right"},[e("span",{attrs:{"data-status":i.billId},on:{click:function(e){return t.btnChangeStutas(i.billId,i.billStatus,s,i.buyingPoint,i.goodId)}}},[t._v("End order")])]):e("div",{staticClass:"again-right"},[e("span",{attrs:{"data-status":i.billId},on:{click:function(e){return t.btnToDetail(i.goodId)}}},[t._v("Buy again")])])])],1)})),0)],1)],1)},a=[],n=e("0eaf"),l=e("99c5"),r=(e("495f"),e("a27e"));e("7c15");function o(){return r["a"].get("/bill-api/v1/GetMybills")}function c(t){return r["a"].post("/bill-api/v1/update",t)}var d=e("360d"),u=e("25e6"),h=e("d399"),b={data(){return{status:"",billStatus:0,loading:!1,finished:!1,refreshing:!1,list:[],page:1,goldPrice:0,silverPrice:0}},computed:{},components:{sHeader:n["a"]},async mounted(){this.timer=setInterval(this.getGold,3e3)},beforeDestroy(){clearInterval(this.timer)},methods:{getGold(){Object(u["c"])().then(t=>{void 0!=t.data.ag&&void 0!=t.data.au&&(this.goldPrice=t.data.au,this.silverPrice=t.data.ag)}).catch(t=>{})},delete(t){let i=!1;return this.list.some((e,s)=>{if(s==t)return i=!0,this.list.splice(s,1),!0}),i},btnToDetail(t){10893==t?this.$router.push({path:"Gold/"+t}):this.$router.push({path:"Sliver/"+t})},btnChangeStutas(t,i,e,s){0==i&&(s>2e3&&0!=this.goldPrice?c({billId:t,billStatus:1,unwindingPoint:this.goldPrice}).then(t=>{let i=this.delete(e);i?h["a"].success("Cancel Success"):h["a"].fail("Cancel Fail")}):s<1e3&&0!=this.silverPrice&&c({billId:t,billStatus:1,unwindingPoint:this.silverPrice}).then(t=>{let i=this.delete(e);i?h["a"].success("Cancel Success"):h["a"].fail("Cancel Fail")}))},btnclick(t){this.billStatus=t,this.getMybills()},async getMybills(){o().then(t=>{let i=t.data,e=[],s=[];i.forEach(t=>{t.billStatus==this.billStatus&&s.push(t)}),s.forEach((t,i)=>{Object(d["a"])(t.goodId).then(a=>{t.detail=a.data,e.push(t),s.length-1==i&&(e.reverse(),this.list=e)}).catch(t=>{})}),this.loading=!1,this.finished=!0}).catch(t=>{this.loading=!1,this.finished=!0})},async loadData(){const{data:t,data:{list:i}}=await Object(l["e"])({pageNumber:this.page,status:this.status});this.list=this.list.concat(i),this.totalPage=t.totalPage,this.loading=!1,this.page>=t.totalPage&&(this.finished=!0)},onChangeTab(t,i){this.billStatus=t,this.onRefresh()},goTo(t){this.$router.push({path:"order-detail?id="+t})},goBack(){this.$router.go(-1)},onLoad(){this.refreshing&&(this.list=[],this.refreshing=!1),this.getMybills()},onRefresh(){this.refreshing=!0,this.finished=!1,this.loading=!0,this.page=1,this.onLoad()}}},g=b,p=(e("8b36"),e("2877")),v=Object(p["a"])(g,s,a,!1,null,"7526f1fa",null);i["default"]=v.exports},"7c15":function(t,i,e){"use strict"},"8b36":function(t,i,e){"use strict";e("b618")},b618:function(t,i,e){}}]);
//# sourceMappingURL=order.dde7d4d3.js.map